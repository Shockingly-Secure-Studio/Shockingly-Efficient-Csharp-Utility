using System.Collections.Generic;
using Newtonsoft.Json;
using UnityEngine.UI;

namespace Service.Exploit
{

    public class ServiceResult
    {
        /// <summary>
        /// The identifier of the service. Represented as the combination ip:port eg. 127.0.0.1:80
        /// </summary>
        [JsonProperty("identifier")]
        public string Identifier { get; set; }
        
        /// <summary>
        /// A list containing all the access points on this service.
        /// </summary>
        public List<AccessPoint> AccessPoints { get; set; }

        public ServiceResult(string ip, int port)
        {
            Identifier = $"{ip}:{port}";
            AccessPoints = new List<AccessPoint>();
        }
    }
    
    public enum AccessPointType
    {
        RCE,
        SQLi,
        InsecureAuthentication
    }
    
    public class AccessPoint
    {
        /// <summary>
        /// Constructor for AccessPoint
        /// </summary>
        /// <param name="access">The way of exploiting the access point.</param>
        /// <param name="poc">A Proof-Of-Concept of this exploit.</param>
        /// <param name="type">The type of the vulnerability.</param>
        /// <param name="severity">The severity of this vulnerability. Usually ranked from 0 to 10 (10 being the most critical).</param>
        public AccessPoint(string access, string poc, AccessPointType type, int severity, string additionnalInfo = "")
        {
            Access = access;
            POC = poc;
            Type = type;
            Severity = severity;
            AdditionalInfo = additionnalInfo;
        }
        
        /// <summary>
        /// The way of exploiting the access point. 
        /// </summary>
        [JsonProperty("access")]
        public string Access { get; set; }
        
        /// <summary>
        /// A Proof-Of-Concept of this exploit.
        /// </summary>
        [JsonProperty("poc")]
        public string POC { get; set; }
        
        /// <summary>
        /// The type of the vulnerability.
        /// </summary>
        [JsonProperty("type")]
        public AccessPointType Type { get; set; }
        
        /// <summary>
        /// The severity of this vulnerability. Usually ranked from 0 to 10 (10 being the most critical).
        /// </summary>
        [JsonProperty("severity")]
        public int Severity { get; set; }
        
        /// <summary>
        /// OPTIONAL: Additional information about the exploit.
        /// </summary>
        public string AdditionalInfo { get; set; }
    }
}